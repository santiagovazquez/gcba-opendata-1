$(document).ready(function(){

    var long = 107533.140625, lat = 102836.5234375;

    _.templateSettings = {
        interpolate: /\{\{\=(.+?)\}\}/g,
        evaluate: /\{\{(.+?)\}\}/g
    };

    StatusBar.init();
    Map.init();
    Searchbox.init(Map, function() { return true; });
    NavigationBar.init();

    AutocompleteGcba.init('autocomplete-bsas', function(direction) {

        long = direction.getCoordenadas().getX();
        lat = direction.getCoordenadas().getY();

        $('ul.unstyled li strong').text(direction.toString());
    });

    function getURLParameter(name) {
        return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
    }

    var exploreFlag = getURLParameter("explore");

    if(typeof(exploreFlag) !== "undefined" && exploreFlag != null && exploreFlag !== ""){
        $('#introduction-modal').modal('show');
    }

//    $('#introduction-modal').modal('show');

    $('html').ajaxError(function(){
        $('#loading').hide();
        $('.navbar-search').show();
        StatusBar.showErrorMessage("Ooops, hubo un error en la comunicación con el servidor. Proba de nuevo más tarde.");
    });
});